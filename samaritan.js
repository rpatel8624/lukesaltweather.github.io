function Record(){$State.isText||(0==recording?(mic.start(),executeSamaritan(recordmsg),recording=!0):(mic.stop(),mic.onresult=function(t,e,n){console.log("Received Response: "+JSON.stringify(n)),console.log("Asset-Input: "+n.msg_body);var i=Calculate(n.msg_body);executeSamaritan("Calculating Response . .. ... "+i)},recording=!1))}function initSamaritan(){executeSamaritan(Init_Message),mic.connect(contoken)}$State={isText:!1,wordTime:750,wordAnim:150,randomInterval:18e3,lastRandomIndex:-1,randomTimer:null,lastMouseUp:-1};var recording=!1,mic=new Wit.Microphone(document.getElementById("microphone"));mic.onready=function(){console.log("Microphone is ready to record")},mic.onaudiostart=function(){console.log("Recording started")},mic.onerror=function(t){executeSamaritan(errmsg),console.log(t)},mic.onaudioend=function(){console.log("stream ended")},mic.onconnecting=function(){console.log("Microphone is connecting")},mic.ondisconnected=function(){console.log("Microphone is not connected")},$.fn.textWidth=function(){var t=$(this).html(),e="<span>"+t+"</span>";$(this).html(e);var n=$(this).find("span:first").width();return $(this).html(t),n},$(document).ready(function(){$State.triangle=$("#triangle"),$State.text=$("#main p"),$State.line=$("#main hr"),blinkTriangle(),initSamaritan(),$(document).bind("mouseup",function(){Date.now()-$State.lastMouseUp<=500&&(console.log("DblClick"),screenfull.enabled&&screenfull.toggle()),$State.lastMouseUp=Date.now()}).bind("click",function(){Record()})});var blinkTriangle=function(){$State.isText||$State.triangle.fadeTo(500,0).fadeTo(500,1,blinkTriangle)},executeSamaritan=function(t,e){if(!$State.isText){$State.isText=!0;var n=t.split(" ");$State.triangle.finish().animate({"font-size":"0em",opacity:"1"},{duration:$State.wordAnim,done:function(){var t=0;n.forEach(function(e,n){var i=$State.wordTime;e.length>8&&(i*=e.length/8),setTimeout(function(){$State.text.addClass("hidden").html(e),$State.line.animate({width:$State.text.textWidth()+18+"px"},{duration:$State.wordAnim,start:$State.text.removeClass("hidden")})},t+$State.wordAnim),t+=i}),setTimeout(function(){$State.text.html(""),$State.triangle.finish().animate({"font-size":"2em",opacity:"1"},{duration:$State.wordAnim,done:function(){$State.isText=!1,blinkTriangle(),$State.line.animate({width:"30px"},{duration:$State.wordAnim,start:$State.text.removeClass("hidden")})}})},t+$State.wordTime)}})}};
